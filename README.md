# Image_caption
***
## 代码简介
* 这个项目使用的数据集是Flickr8k数据集，每张图片都有五段对应的不同描述（有中文也有英文），项目的最终结果是为了训练一个能够提取图片特征以及语料特征的生成器模型，最终能够对一张图片自动生成描述，这些描述均来自词库。
  在这个项目中仍然有较多未完善的地方，例如模型的CNN部分，我使用的是YOLOv3的作为图片特征提取，结果并没有我预期那么好（原因是没有考虑提取之后多尺度图片特征的空间顺序问题？）以及RNN部分没有很好的一个网络，最终模型效果出现了过拟合。
## 网络结构
* 模型根据语料处理分类：词袋模型，词向量模型两种，经过测试分类模型最终效果优于回归模型。
- 词袋模型结构如下：
- ![bw_model](https://github.com/2186685150/Image_caption/assets/116703314/30fa4dac-79df-4139-b460-39b3992d9c1c)
- 词向量模型如下：
- ![wv_model](https://github.com/2186685150/Image_caption/assets/116703314/88a0756f-5e30-4011-adff-04197b8387c8)
- 可以看到两者之间仅在输入层以及输出层有较大差距。
## 模型输出效果
* 在使用一张RTX A5000算力支持下，两个模型训练均使用了6小时左右训练时间达到收敛，模型指标在50%-70%之间。
- 测试图片：
- ![图片3](https://github.com/2186685150/Image_caption/assets/116703314/7687ec59-b112-42f9-94bd-a01bdc47a3a4)
* 词袋预测输出结果：
- ![图片1](https://github.com/2186685150/Image_caption/assets/116703314/1d8925ef-6ded-484a-87e6-3180cc7ecc64)
- 词向量预测输出结果：
- ![图片2](https://github.com/2186685150/Image_caption/assets/116703314/e296d6c2-250f-4bd9-b603-d3b1d96fc618)
# 改进方法
* 考虑使用ResNet50、VGG16等常规CNN网络进行图片特征提取，获得更好的图片特征提取部分效果；
* 使用更大的语料数据集进行模型训练，上述模型训练集：验证集=6000：1000，效果较差，且中文语料描述存在较多误差；
* 改进RNN部分网络，使用更为合理的网络进行拟合训练；
